# 使用 Chrome DevTools MCP 执行测试的详细步骤

## 前提条件

1. ✅ 确保 Chrome DevTools MCP 已配置（参见 `devtools-mcp-setup-guide.md`）
2. ✅ 开发服务器正在运行：`http://localhost:3002`
3. ✅ 在 Claude Code 或 Cursor 中打开本项目

## 执行流程

### 阶段1：基础功能测试（10分钟）

#### 测试1：页面加载和基础渲染

**复制以下提示词到 Claude Code/Cursor**：

```
请使用 Chrome DevTools MCP 测试 http://localhost:3002 的 WSJF Sprint Planner 应用：

测试套件1：页面加载和基础渲染

1. 打开页面 http://localhost:3002
2. 等待页面完全加载（networkidle）
3. 执行以下检查：

   ✅ 页面标题检查
   - 获取页面标题（document.title）
   - 验证标题包含 "WSJF"

   ✅ 控制台错误检查
   - 列出所有控制台消息
   - 验证没有 error 级别的消息

   ✅ 核心元素存在性检查
   - 检查是否存在文本 "WSJF Sprint Planner"
   - 检查是否存在文本 "待排期"
   - 检查是否存在文本 "迭代池"
   - 检查按钮："新建需求"、"新建迭代池"、"导出 JSON"、"导入"
   - 检查按钮："WSJF-Lite 评分说明书"

   ✅ 数据加载检查
   - 使用 evaluate_script 查询需求卡片数量
   - 验证至少有一个需求卡片存在

4. 截图保存为当前对话

请详细记录每一步的结果，包括成功和失败的检查项。
```

**预期输出**：测试报告包含所有检查项的结果

---

#### 测试2：需求卡片功能

**复制以下提示词**：

```
测试套件2：需求卡片功能

在同一页面（http://localhost:3002）继续测试：

1. 需求卡片基本信息
   - 使用 evaluate_script 查找所有 class 包含 "bg-white" 和 "rounded-lg" 的卡片
   - 获取第一个卡片的文本内容
   - 验证卡片包含：标题、描述或业务信息

2. 评分信息显示
   - 查找包含 "权重分" 文本的卡片
   - 验证至少有一个卡片显示权重分
   - 检查该卡片是否也显示星级符号（★）

3. 不可排期需求验证
   - 查找包含 "待评估" 或 "未评估" 文本的卡片
   - 验证这些卡片不显示 "权重分"

4. 拖拽功能检查
   - 查找具有 draggable="true" 属性的元素
   - 统计可拖拽卡片的数量

5. 颜色渐变检查
   - 查找 class 包含 "bg-gradient-to-r" 的元素
   - 验证至少有一个卡片有渐变背景

6. 编辑功能
   - 查找编辑按钮（title="编辑" 或 文本="编辑"）
   - 点击第一个编辑按钮
   - 验证弹窗打开（检查是否出现 "编辑需求" 文本）
   - 点击"取消"按钮关闭弹窗

7. 截图当前状态

请提供详细的测试报告。
```

---

#### 测试3：编辑需求弹窗

**复制以下提示词**：

```
测试套件3：需求编辑弹窗

继续在 http://localhost:3002 测试：

1. 打开新建需求弹窗
   - 点击 "新建需求" 按钮
   - 等待弹窗出现（等待 "新建需求" 或 "编辑需求" 文本出现）

2. 表单字段完整性检查
   使用 evaluate_script 检查以下元素是否存在：

   基本信息部分：
   - label 包含 "需求标题"
   - input 或 textarea 用于标题输入
   - label 包含 "需求描述"
   - textarea 用于描述输入

   业务评估部分：
   - label 包含 "业务影响度"
   - select 用于业务影响度选择
   - label 包含 "时间窗口"
   - input[type="radio"] 用于时间窗口选择

   技术评估部分：
   - label 包含 "技术复杂度"
   - select 用于技术复杂度选择
   - label 包含 "预估工作量"
   - input 用于工作量输入

3. 表单交互测试
   - 在标题输入框填入："DevTools MCP 测试需求"
   - 在描述框填入："这是通过 DevTools MCP 创建的测试需求"
   - 验证输入值是否正确填充

4. 按钮类型验证（重要！）
   使用 evaluate_script 检查：
   - 所有按钮的 type 属性
   - 验证 "保存" 和 "取消" 按钮的 type 都是 "button"
   - 这很重要，因为缺少 type 会导致表单提交和文件下载 bug

5. 实时预览检查
   - 查找是否有 "实时预览" 或 "预览" 相关的文本或区域

6. 弹窗样式检查
   - 截图当前弹窗状态
   - 检查是否有蓝色渐变的标题栏
   - 检查是否有不同颜色的 section（绿色、蓝色等）

7. 关闭弹窗
   - 点击 "取消" 按钮
   - 验证弹窗已关闭

请提供完整的测试报告和截图。
```

---

### 阶段2：高级功能测试（10分钟）

#### 测试4：筛选和排序

**复制以下提示词**：

```
测试套件4：筛选和排序功能

在 http://localhost:3002 的待排期区域测试：

1. 筛选控件检查
   - 查找所有 select 元素
   - 获取每个 select 的选项列表
   - 识别业务线、产品进展、技术进展的筛选器

2. 需求分组验证
   - 查找 "可排期" 相关的文本或区域
   - 查找 "不可排期" 相关的文本或区域
   - 统计每个组中的需求数量

3. 排序验证
   - 获取所有显示权重分的需求
   - 提取权重分数值
   - 验证是否按降序排列（从高到低）

4. 筛选功能测试
   - 记录当前显示的需求数量
   - 选择一个筛选选项（如选择特定的技术进展状态）
   - 等待页面更新
   - 再次统计需求数量
   - 验证数量发生了变化

5. 截图筛选器区域

请提供测试结果。
```

---

#### 测试5：迭代池管理

**复制以下提示词**：

```
测试套件5：迭代池功能

测试迭代池的创建和管理：

1. 新建迭代池
   - 点击 "新建迭代池" 按钮
   - 等待弹窗打开
   - 填写表单：
     * 迭代名称：输入 "DevTools MCP 测试迭代 Sprint-1"
     * 总人天：输入 "20"
     * 已占用：输入 "5"
   - 点击保存按钮
   - 验证弹窗关闭

2. 验证新建的迭代池
   - 在页面上查找 "DevTools MCP 测试迭代" 文本
   - 验证迭代池显示了容量信息
   - 检查是否显示 15 人天的净可用容量

3. 迭代池结构检查
   - 查找所有迭代池容器
   - 检查每个迭代池的基本信息（名称、容量）

4. 截图迭代池区域

请提供测试结果。
```

---

#### 测试6：导入导出功能

**复制以下提示词**：

```
测试套件6：导入导出功能

测试数据的导入导出：

1. 导出功能
   - 点击 "导出 JSON" 按钮
   - 使用 list_network_requests 检查是否有下载相关的网络请求
   - 或使用 evaluate_script 检查是否触发了下载事件

2. 导入功能UI检查
   - 点击 "导入" 按钮
   - 检查是否出现文件选择相关的界面或弹窗
   - 查找 input[type="file"] 元素

3. 截图导入导出控制区域

注意：实际的文件操作可能受限于浏览器安全限制。

请提供测试结果。
```

---

#### 测试7：WSJF说明书

**复制以下提示词**：

```
测试套件7：WSJF-Lite 评分说明书

测试说明书弹窗：

1. 打开说明书
   - 点击 "WSJF-Lite 评分说明书" 按钮
   - 等待弹窗出现

2. 内容验证
   - 检查弹窗标题是否为 "WSJF-Lite 评分说明书"
   - 使用 evaluate_script 获取说明书的主要内容
   - 验证包含以下关键信息：
     * 业务影响度说明
     * 时间窗口说明
     * 强制截止说明
     * 工作量评分说明

3. 滚动和样式检查
   - 截图说明书顶部
   - 滚动到底部
   - 截图说明书底部

4. 关闭说明书
   - 点击关闭按钮（X 或 "关闭"）
   - 验证弹窗已关闭

请提供测试结果和截图。
```

---

#### 测试8：拖拽功能

**复制以下提示词**：

```
测试套件8：拖拽功能测试

测试需求卡片的拖拽功能：

1. 拖拽元素检查
   - 查找所有 draggable="true" 的元素
   - 统计可拖拽元素的数量

2. 放置区域检查
   - 查找迭代池的放置区域
   - 检查是否有接收拖拽的提示文本或样式

3. 拖拽操作尝试（如果可能）
   - 选择一个可排期的需求卡片
   - 尝试模拟拖拽事件：
     * 触发 dragstart 事件
     * 设置 dataTransfer 数据
     * 触发 drop 事件到迭代池
   - 验证需求是否移动到迭代池

4. 拖拽反馈检查
   - 使用 hover 悬停在可拖拽元素上
   - 检查是否有视觉反馈（cursor 变化等）

5. 截图拖拽相关界面

注意：完整的拖拽操作可能在 DevTools MCP 中有限制。

请提供测试结果。
```

---

### 阶段3：性能和响应式测试（5分钟）

#### 测试9：性能分析（DevTools MCP 的独特优势）

**复制以下提示词**：

```
测试套件9：性能分析

使用 Chrome DevTools MCP 的性能分析功能：

1. 启动性能追踪
   - 使用 performance_start_trace 开始追踪

2. 执行关键用户流程
   - 刷新页面
   - 打开新建需求弹窗
   - 填写部分表单字段
   - 关闭弹窗
   - 点击一个需求卡片的编辑按钮
   - 再次关闭弹窗

3. 停止追踪并分析
   - 使用 performance_stop_trace 停止追踪
   - 使用 performance_analyze_insight 分析性能数据

4. 生成性能报告
   请提供以下指标：
   - LCP (Largest Contentful Paint) - 最大内容绘制时间
   - FCP (First Contentful Paint) - 首次内容绘制时间
   - CLS (Cumulative Layout Shift) - 累积布局偏移
   - TTI (Time to Interactive) - 可交互时间
   - 主要性能瓶颈识别
   - 优化建议

5. 网络性能分析
   - 使用 list_network_requests 列出所有网络请求
   - 分析：
     * 请求总数
     * 最大的资源文件
     * 加载时间最长的请求
     * 是否有失败的请求

这是 DevTools MCP 相比 Playwright 的独特优势！

请提供详细的性能分析报告。
```

---

#### 测试10：响应式设计

**复制以下提示词**：

```
测试套件10：响应式设计测试

测试不同屏幕尺寸下的显示：

1. 桌面端测试（当前）
   - 截图当前桌面视图
   - 保存为 "桌面端-1920x1080"

2. 移动端测试
   - 使用 resize_page 调整到移动设备尺寸：
     * 宽度：375px
     * 高度：667px (iPhone SE)
   - 等待页面重新渲染
   - 检查：
     * 是否有横向滚动条
     * 按钮是否可见和可点击
     * 文字是否可读
     * 卡片布局是否适配
   - 截图移动端视图

3. 平板端测试
   - 使用 resize_page 调整到平板尺寸：
     * 宽度：768px
     * 高度：1024px (iPad)
   - 检查布局适配情况
   - 截图平板端视图

4. 恢复桌面尺寸
   - 使用 resize_page 恢复：
     * 宽度：1920px
     * 高度：1080px

5. 响应式断点分析
   - 在不同宽度下观察布局变化
   - 识别主要的响应式断点

请提供各尺寸的截图和布局分析。
```

---

## 测试完成后

### 收集测试结果

将所有测试结果汇总到一个文档中：

```
请帮我汇总以上所有测试的结果，生成一份完整的测试报告，包括：

1. **测试总览**
   - 执行日期和时间
   - 测试环境信息
   - 执行的测试套件数量

2. **通过的测试**
   - 列出所有通过的测试项
   - 统计通过率

3. **失败的测试**
   - 列出所有失败的测试项
   - 失败原因分析
   - 截图证据

4. **性能报告**
   - 关键性能指标
   - 性能问题和建议

5. **Bug 列表**
   - 发现的所有 bug
   - 严重程度分类
   - 重现步骤

6. **对比 Playwright**
   - DevTools MCP 的优势
   - DevTools MCP 的局限
   - 建议的使用场景

请将报告保存为 Markdown 格式。
```

---

## 快速启动脚本

如果你希望快速开始，可以直接复制以下"一键测试"提示词：

```
请使用 Chrome DevTools MCP 对 http://localhost:3002 的 WSJF Sprint Planner 进行完整的自动化测试。

测试范围包括：
1. ✅ 页面加载和基础渲染
2. ✅ 需求卡片功能（显示、编辑、拖拽）
3. ✅ 需求编辑弹窗（所有表单字段和按钮）
4. ✅ 筛选和排序功能
5. ✅ 迭代池管理
6. ✅ 导入导出
7. ✅ WSJF说明书
8. ✅ 拖拽交互
9. ✅ 性能分析（LCP, FCP, CLS, 网络请求）
10. ✅ 响应式设计（桌面、移动、平板）

对于每个测试：
- 详细记录测试步骤和结果
- 在关键位置截图
- 记录发现的任何问题或 bug
- 提供性能优化建议

最后生成一份完整的测试报告，包括：
- 测试总结
- 通过/失败统计
- Bug 列表
- 性能报告
- 与 Playwright 的对比分析

请开始测试。
```

---

## 注意事项

1. **测试执行顺序**：建议按照上述顺序执行，因为后续测试可能依赖前面的状态

2. **截图管理**：DevTools MCP 的截图会保存在对话历史中，但建议定期导出重要截图

3. **性能测试独特性**：性能分析是 DevTools MCP 的独特优势，Playwright 难以提供同等深度的分析

4. **拖拽限制**：复杂的拖拽操作在 DevTools MCP 中可能受限，这是已知的局限

5. **网络条件模拟**：可以使用 `emulate_network` 模拟慢速网络，测试在不同网络条件下的表现

6. **CPU 节流**：可以使用 `emulate_cpu` 模拟低性能设备

---

## 对比分析框架

测试完成后，使用以下框架对比两种工具：

| 维度 | Playwright | DevTools MCP |
|------|-----------|-------------|
| **执行速度** | ⚡⚡⚡⚡⚡ 非常快 | ⚡⚡⚡ 中等速度 |
| **测试准确性** | ⚡⚡⚡⚡⚡ 非常准确 | ⚡⚡⚡⚡ 较准确 |
| **性能分析** | ⚡⚡ 基础分析 | ⚡⚡⚡⚡⚡ 深度分析 |
| **拖拽支持** | ⚡⚡⚡⚡⚡ 完整支持 | ⚡⚡⚡ 有限支持 |
| **灵活性** | ⚡⚡⚡ 脚本化 | ⚡⚡⚡⚡⚡ AI驱动 |
| **学习曲线** | ⚡⚡⚡ 需要编程 | ⚡⚡⚡⚡⚡ 自然语言 |
| **可重复性** | ⚡⚡⚡⚡⚡ 完全可重复 | ⚡⚡⚡⚡ 大部分可重复 |
| **调试能力** | ⚡⚡⚡⚡ 较强 | ⚡⚡⚡⚡⚡ 非常强 |

---

## 支持

如有问题，请参考：
- 📖 [DevTools MCP 配置指南](./devtools-mcp-setup-guide.md)
- 📋 [DevTools MCP 测试计划](./devtools-mcp-test-plan.md)
- 🎯 [Playwright 测试套件](../tests/comprehensive/)
