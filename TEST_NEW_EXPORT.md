# 🧪 测试新导出功能

## 🎯 测试目标

验证 v1.6.0 双模式导出功能是否正常工作。

---

## 📍 界面上的按钮位置

打开应用后，在顶部工具栏（右上角）会看到：

```
[导入] [从飞书导入] [导入数据] [🟢新导出] [导出] [退出登录]
                                   ↑
                            点击这个绿色按钮
```

---

## ✅ 测试步骤

### 1. 点击"新导出"按钮

点击绿色的"新导出"按钮，应该弹出一个模态框。

### 2. 查看导出模式选择

模态框中应该显示两个选项：

#### 📄 展示模式
```
✓ 单Sheet导出
✓ 30+扩展字段
✗ 不支持完整还原
```

#### 💾 数据模式
```
✓ 多Sheet结构
✓ 完整字段保留
✓ 支持导入还原
```

### 3. 测试展示模式导出

1. 选择"展示模式"
2. 点击"导出"按钮
3. 下载文件：`WSJF排期_展示模式_2025-01-12.xlsx`
4. 用 Excel 打开文件
5. **验证字段数量**：应该有 **30+ 列**

**期望看到的字段**：
```
迭代池、需求名称、需求提交人、提交方、提交日期、业务团队
产品经理、后端研发、前端研发、测试、项目名称、产品领域
需求类型、工作量(天)、业务影响度、影响指标、影响范围
技术复杂度、迫切程度、强制DDL、DDL日期、权重分、星级
产品进度、技术进度、业务域、业务子域、RMS、依赖需求数、产研备注
```

### 4. 测试数据模式导出（Excel）

1. 选择"数据模式"
2. 选择"Excel (.xlsx)"
3. 点击"导出"按钮
4. 下载文件：`WSJF排期_完整备份_2025-01-12.xlsx`
5. 用 Excel 打开文件
6. **验证 Sheet 数量**：应该有 **4个 Sheet**

**期望看到的 Sheet**：
```
Sheet 1: 元数据 - 版本、时间戳等
Sheet 2: 需求数据 - 完整需求列表
Sheet 3: 迭代池配置 - 迭代池信息
Sheet 4: 待排期列表 - 未排期需求ID
```

### 5. 测试数据模式导出（JSON）

1. 选择"数据模式"
2. 选择"JSON (.json)"
3. 点击"导出"按钮
4. 下载文件：`WSJF排期_完整备份_2025-01-12.json`
5. 用文本编辑器打开
6. **验证 JSON 结构**：

```json
{
  "metadata": {
    "version": "1.6.0",
    "exportedAt": "...",
    "exportMode": "data",
    "dataStatistics": { ... }
  },
  "requirements": [ ... ],
  "sprintPools": [ ... ],
  "unscheduledIds": [ ... ]
}
```

---

## 🔍 对比测试

### 旧导出（灰色"导出"按钮）

点击灰色的"导出"按钮 → "导出为 Excel"

**字段数量**：17个
```
迭代池、需求名称、需求提交人、产品经理、研发同学、类型
工作量(天)、业务影响度、技术复杂度、迫切程度、强制DDL
DDL日期、权重分、星级、技术评估、业务域、RMS
```

### 新导出（绿色"新导出"按钮）

点击绿色的"新导出"按钮 → 展示模式

**字段数量**：30+个（多了13+个字段）

**新增字段**：
```
提交方、提交日期、业务团队、后端研发、前端研发、测试
项目名称、产品领域、影响指标、影响范围、产品进度
业务子域、依赖需求数、产研备注
```

---

## ❌ 可能的问题

### 问题1：找不到"新导出"按钮

**原因**：可能缓存问题

**解决**：
```
1. 强制刷新页面：Ctrl + Shift + R (Windows) 或 Cmd + Shift + R (Mac)
2. 清除浏览器缓存
3. 尝试隐身模式
```

### 问题2：导出的文件字段还是17个

**原因**：点击的是旧的"导出"按钮

**解决**：
```
确保点击的是绿色的"新导出"按钮，而不是灰色的"导出"按钮
```

### 问题3：点击"新导出"没有反应

**原因**：JavaScript 错误

**解决**：
```
1. 打开浏览器开发者工具（F12）
2. 查看 Console 标签页
3. 截图错误信息并反馈
```

---

## 📊 预期结果

| 功能 | 旧导出 | 新导出（展示模式） | 新导出（数据模式） |
|------|--------|-------------------|-------------------|
| 字段数量 | 17个 | 30+个 | 完整（所有字段） |
| Sheet数量 | 1个 | 1个 | 4个 |
| 支持导入 | ❌ | ❌ | ✅ |
| 格式选择 | Excel only | Excel only | Excel/JSON |

---

## 🐛 如果测试失败

请提供以下信息：

1. **访问地址**：你访问的是哪个URL？
2. **浏览器**：Chrome / Firefox / Safari / Edge？
3. **按钮状态**：看到绿色"新导出"按钮了吗？
4. **导出文件**：导出的文件名是什么？字段有多少列？
5. **控制台错误**：F12 开发者工具中的 Console 有错误吗？
6. **截图**：最好提供界面截图

---

## ✅ 成功标准

测试通过的标准：

- ✅ 能看到绿色"新导出"按钮
- ✅ 点击后弹出导出模式选择对话框
- ✅ 展示模式导出有 30+ 个字段
- ✅ 数据模式导出有 4 个 Sheet
- ✅ JSON 导出格式正确
- ✅ 导出的文件可以正常打开

---

**测试时间**：5-10 分钟
**重要程度**：🔴 高（核心功能）
