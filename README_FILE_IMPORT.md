# WSJF文件导入功能使用手册

## 🎯 支持的文件格式

### ✅ 完全支持（无需额外工具）

| 格式 | 扩展名 | 用途 |
|------|--------|------|
| Excel | `.xlsx`, `.xls`, `.csv` | 批量导入多条需求 |
| **Word** | `.docx` | 导入需求文档 |
| PDF | `.pdf` | 导入需求文档（需有文字层） |
| 文本 | `.txt` | 导入纯文本需求 |

### ⚠️ 需要预处理

| 格式 | 说明 | 解决方案 |
|------|------|----------|
| 扫描PDF | 无文字层的PDF | 使用在线OCR转换 |
| 图片 | `.png`, `.jpg`等 | 使用在线OCR转换 |

---

## 🚀 快速开始

### 基本导入流程

```
1. 点击"导入"按钮
2. 选择文件（现在支持Excel、Word、PDF、图片、文本）
3. 查看提取的内容
4. 检查字段映射
5. 点击"确认导入"
```

---

## 📝 各格式使用说明

### Excel文件（推荐批量导入）

**特点**:
- 一次导入多条需求
- 自动字段映射
- 最高效

**使用**:
```
1. 准备Excel文件，格式如下：
   | 需求名称 | 提交人 | 工作量 | ...  |
   | 需求A   | 张三   | 5      | ...  |
   | 需求B   | 李四   | 3      | ...  |

2. 点击"导入"，选择Excel文件

3. 系统自动映射字段：
   需求名称 → name
   提交人 → submitterName
   工作量 → effortDays

4. 确认导入
```

---

### Word文档（新功能！）

**特点**:
- 提取完整文本内容
- 适合详细需求文档
- 浏览器端直接解析

**使用**:
```
1. 准备Word文档(.docx格式)：
   - 包含需求描述
   - 可以有格式、标题等

2. 点击"导入"，选择.docx文件

3. 系统提取所有文本，映射为：
   - 文件名 → 需求名称
   - 文档内容 → 需求描述

4. 确认导入
```

**注意**:
- ✅ 支持: `.docx` (Office 2007及以后)
- ❌ 不支持: `.doc` (旧格式)

如有`.doc`文件，请在Word中另存为`.docx`

---

### PDF文档

**特点**:
- 自动检测文字层
- 智能OCR提示
- 多CDN fallback

**使用**:
```
1. 点击"导入"，选择PDF文件

2. 系统自动检测:
   a) 有文字层 → 成功提取文本
   b) 扫描件 → 显示OCR建议

3. 如果是扫描件:
   - 看到OCR建议提示
   - 使用在线工具转换（推荐）
   - 或使用本地OCR工具（需环境）

4. 导入转换后的文件
```

**在线OCR工具推荐**:
- iLovePDF: https://www.ilovepdf.com/zh-cn/pdf_to_text
- Adobe: https://www.adobe.com/acrobat/online/pdf-to-text.html
- 搜狗OCR: https://ocr.sogou.com/

---

### 图片文件

**支持格式**: `.png`, `.jpg`, `.jpeg`, `.webp`, `.bmp`, `.tiff`

**使用**:
```
1. 点击"导入"，可以选择图片文件

2. 系统尝试提取文本（通过OCR检测）

3. 如果需要OCR:
   - 使用在线OCR工具转换
   - 上传转换后的文本

4. 确认导入
```

---

### 文本文件

**最简单的格式**

**使用**:
```
1. 准备.txt文件

2. 点击"导入"，选择文件

3. 系统直接读取内容

4. 映射到需求描述字段

5. 确认导入
```

---

## 💡 最佳实践

### 1. 选择合适的格式

| 场景 | 推荐格式 | 原因 |
|------|---------|------|
| 批量导入多条 | Excel | 最高效 |
| 详细需求文档 | Word | 格式保留好 |
| 简单文本 | 文本文件 | 最简单 |
| 现有PDF | PDF | 直接导入 |

### 2. Excel模板建议

创建标准Excel模板，包含以下列：

```
| 需求名称 | 提交人 | 产品经理 | 开发人员 | 工作量 | 业务影响度 | 时间窗口 | 强制截止 |
```

这样可以实现最佳的自动映射。

### 3. Word文档建议

Word文档结构化，例如：

```
需求名称：xxx
提交人：xxx
工作量：xxx人天

需求描述：
...

验收标准：
...
```

导入后可以在编辑界面完善其他字段。

### 4. 处理扫描PDF

**推荐流程**:
```
1. 使用在线OCR转换为文本
2. 复制文本，创建.txt文件
3. 导入.txt文件
```

**或者**:
```
1. 使用在线OCR转换为Word
2. 另存为.docx
3. 导入.docx文件
```

---

## 🔧 故障排除

### 问题1: Word文件导入失败

**可能原因**:
- 文件是.doc格式（不支持）
- 文件损坏

**解决**:
- 在Word中另存为.docx
- 检查文件是否能在Word中打开

### 问题2: PDF提取为空

**可能原因**:
- PDF是扫描件（无文字层）

**解决**:
- 查看OCR建议提示
- 使用在线工具转换

### 问题3: 字段映射不正确

**解决**:
- 在导入界面手动调整映射
- 或在Excel中使用标准列名

### 问题4: 大文件导入慢

**原因**: 文件大小超过10MB

**解决**:
- 压缩文件
- 或分割为多个小文件

---

## 📊 字段映射规则

### 自动识别的字段

| Excel列名 | Word/PDF中的关键词 | 映射到 |
|-----------|-------------------|--------|
| 需求名称、名称、文件名 | - | name |
| 提交人、作者 | - | submitterName |
| 产品经理、PM | - | productManager |
| 开发人员、研发 | - | developer |
| 工作量、人天 | - | effortDays |
| 提取内容、内容、描述 | - | description |

### 手动调整

在导入预览界面，可以：
- 点击字段下拉框
- 选择正确的目标字段
- 重新映射

---

## 🎯 典型场景

### 场景1: 批量导入需求池

```
1. 准备Excel：
   - 包含所有待排期需求
   - 每行一条需求
   - 包含基本信息

2. 导入Excel文件

3. 一次性导入所有需求

4. 在系统中进行排期
```

### 场景2: 导入需求文档

```
1. PM编写Word需求文档

2. 导出为.docx

3. 导入到系统

4. 需求描述字段自动填充

5. 手动补充评分信息
```

### 场景3: 导入会议纪要

```
1. 会议记录保存为.txt或.docx

2. 导入到系统

3. 从内容中提炼需求

4. 补充必要字段
```

---

## 📞 获取帮助

**文档**:
- 功能总结: `COMPLETE_FILE_SUPPORT_SUMMARY.md`
- PDF/图片: `docs/PDF_IMAGE_IMPORT_GUIDE.md`
- OCR工具: `scripts/ocr-tools/README.md`
- 故障排除: `scripts/ocr-tools/TROUBLESHOOTING.md`

**测试**:
- 开发服务器: http://localhost:3001
- 测试文件: `test-files/test-requirement.txt`

---

## 🎉 开始使用

**现在就可以**:

1. **打开应用**: http://localhost:3001

2. **点击"导入"**

3. **选择文件**:
   - ✅ Excel → 批量导入
   - ✅ Word → 文档导入
   - ✅ PDF → 文本提取
   - ✅ 文本 → 直接导入

4. **享受新功能**！

---

**版本**: v1.1.0
**更新日期**: 2025-10-26
**新增格式**: Word (.docx)
**优化功能**: PDF/图片OCR检测
