# 数据导入导出需求文档

## 需求概述
- **功能名称**: Excel批量导入导出、数据持久化
- **业务价值**: 批量管理需求、数据备份、团队协作
- **优先级**: 🟡 P1 - 重要功能

## 核心功能

### 1. Excel 导出

**导出内容：**
- 所有需求（待排期 + 已排期）
- 字段：需求名称、权重分、星级、业务影响度、技术复杂度、工作量、时间窗口、DDL、业务域、类型、PM、研发、进度等

**导出格式：**
- 文件名：`WSJF需求列表_YYYYMMDD_HHMMSS.xlsx`
- 第一行：表头
- 第二行开始：数据
- 星级用 ★ 符号表示

**操作：**
- 点击"导出Excel"按钮
- 自动下载文件

### 2. Excel 导入

**导入流程：**
1. 点击"导入Excel"按钮
2. 选择 .xlsx 文件
3. 系统解析Excel，显示预览
4. 智能列映射（可选使用AI辅助）
5. 确认后批量导入
6. 导入成功提示

**列映射：**
- 自动识别常见列名（如"需求名称"、"工作量"等）
- 支持手动调整映射关系
- 必填字段验证：需求名称、工作量

**AI智能映射（可选）：**
- 使用Gemini API分析Excel列名
- 自动建议映射关系
- 提取需求描述等信息

### 3. 清空并导入

**需求：**
- 导入预览界面底部提供"清空已有需求并导入全新数据"复选框
- 勾选后，导入时清空所有现有需求
- 红色警告文字：防止误操作
- 成功消息："已清空原有数据并导入 X 条新需求"

### 4. 数据持久化

**LocalStorage 存储：**
```typescript
// 需求列表
localStorage.setItem('wsjf_requirements', JSON.stringify(requirements));

// 迭代池
localStorage.setItem('wsjf_sprint_pools', JSON.stringify(sprintPools));

// 用户信息
localStorage.setItem('wsjf_user', JSON.stringify(user));
```

**自动保存：**
- 新增/编辑/删除需求时自动保存
- 拖拽排期后自动保存
- 无需手动保存按钮

**数据恢复：**
- 应用启动时自动从LocalStorage加载
- 如果数据损坏，使用空数组初始化

## 数据格式

**Excel导出示例：**
| 需求名称 | 权重分 | 星级 | 业务影响度 | 技术复杂度 | 工作量 | ...  |
|---------|--------|------|-----------|-----------|--------|------|
| 需求1   | 85     | ★★★★★| 8         | 6         | 15     | ...  |
| 需求2   | 72     | ★★★★ | 7         | 7         | 20     | ...  |

## 验收标准
- [ ] 导出Excel包含所有字段
- [ ] 导入Excel成功，数据正确
- [ ] 列映射功能正常
- [ ] 清空并导入功能正常，有警告提示
- [ ] LocalStorage自动保存和恢复
- [ ] 数据恢复后状态正确（权重分、星级、排序）

**最后更新**: 2025-01-19
