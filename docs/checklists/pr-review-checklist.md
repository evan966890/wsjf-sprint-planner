# PR审查清单 (Pull Request Review Checklist)

使用此清单确保每个Pull Request都符合项目质量标准。

---

## 📋 基本信息检查

```
□ PR标题清晰描述了变更内容
□ PR描述包含了变更原因和影响范围
□ 关联了相关的Issue或需求
□ 选择了正确的目标分支
□ 没有合并冲突
□ CI/CD检查全部通过
```

---

## 🔍 代码质量检查

### 文件大小
```
□ 所有文件都小于500行
□ 没有文件在300-500行之间（警告区）
□ 运行 npm run check-file-size 通过
```

### 代码组织
```
□ UI和逻辑已分离（组件+Hook）
□ 常量已提取到独立文件
□ 重复代码已提取为工具函数
□ 大组件已拆分为子组件
□ 文件结构清晰合理
```

### 类型安全
```
□ 没有使用 any 类型
□ 所有枚举值定义为联合类型
□ 所有枚举常量在constants/中定义
□ 没有硬编码字符串（使用常量）
□ 分组/筛选逻辑穷举所有值
□ 添加了运行时验证（开发环境）
```

### 命名规范
```
□ 文件命名符合规范（PascalCase/camelCase）
□ 变量命名清晰有意义
□ 布尔值使用is/has/should前缀
□ 常量使用UPPER_SNAKE_CASE
□ 函数名使用动词开头
```

---

## 📝 文档和注释

```
□ 所有导出函数有JSDoc注释
□ 复杂逻辑有内联注释说明
□ 接口和类型有清晰注释
□ 更新了相关的README或文档
□ 删除了注释掉的代码
□ 没有过期的TODO注释
```

---

## 🎨 UI/UX检查

### 样式一致性
```
□ 使用了设计系统中的颜色
□ 间距使用8px网格系统
□ 字体大小符合规范
□ 按钮样式统一
□ 所有button标签有type属性
```

### 交互状态
```
□ 有hover状态
□ 有focus状态（焦点环）
□ 有active状态
□ 有disabled状态
□ 有loading状态（如适用）
□ 使用了过渡动画
```

### 响应式设计
```
□ 在移动端正常显示
□ 在平板端正常显示
□ 在桌面端正常显示
□ 使用了响应式断点
```

### 可访问性
```
□ 表单元素有正确的label
□ 按钮有清晰的文本或aria-label
□ 颜色对比度足够
□ 支持键盘导航
```

---

## 🔒 安全检查

### CSRF防护
```
□ OAuth回调有state参数验证
□ 所有状态修改操作有防护
□ 没有在URL中暴露敏感信息
```

### XSS防护
```
□ 用户输入有适当转义
□ 使用React的安全渲染（不用dangerouslySetInnerHTML）
□ 外部链接使用rel="noopener noreferrer"
```

### 输入验证
```
□ 前端有表单验证
□ 数值有范围检查
□ 字符串有长度限制
□ 日期有格式验证
```

参考：[安全规范](../standards/security-standards.md)

---

## 💧 资源管理检查

```
□ setTimeout/setInterval有清理
□ useEffect有cleanup函数
□ 事件监听器有移除
□ 异步操作可取消（AbortController）
□ 没有内存泄漏风险
```

参考：[资源管理规范](../standards/resource-management.md)

---

## ⚡ 性能检查

```
□ 没有不必要的重渲染
□ 使用了React.memo（如适用）
□ 使用了useMemo/useCallback（如适用）
□ 图片有懒加载
□ 大列表有虚拟滚动（如适用）
□ API请求有防抖/节流（如适用）
```

---

## 🧪 测试检查

```
□ 添加了单元测试（核心逻辑）
□ 测试覆盖率≥80%（如适用）
□ 手动测试了所有功能
□ 测试了错误场景
□ 测试了边界条件
□ 在不同浏览器测试（Chrome/Firefox/Safari）
```

---

## 🔄 重构相关（如适用）

如果是重构PR，必须检查：

```
□ 重构前已截图保存UI
□ 运行了npm run dev验证
□ UI样式与重构前一致
□ 所有交互功能正常
□ 没有控制台错误
□ 性能没有下降
```

参考：[重构规范](../standards/refactoring-standards.md)

---

## 📦 依赖管理

```
□ 只添加了必要的依赖
□ 依赖版本是稳定版本
□ package.json和package-lock.json同步
□ 没有安全漏洞（npm audit）
□ 依赖大小合理（bundle size）
```

---

## 📊 数据处理

```
□ 数组操作有边界检查
□ 除法有除以0防护
□ 可选链用于可能为null的属性
□ 默认值处理完善
□ 数据验证完整
```

---

## 🚀 部署相关

```
□ 没有console.log（生产环境）
□ 没有debugger语句
□ 环境变量使用正确
□ API端点配置正确
□ 构建成功（npm run build）
□ 预览正常（npm run preview）
```

---

## 📱 特定功能检查

### 表单相关
```
□ 必填字段有星号标注
□ 表单验证提示清晰
□ 提交按钮有loading状态
□ 表单可以正确提交
□ 错误提示用户友好
```

### 列表/表格相关
```
□ 分页功能正常
□ 排序功能正常
□ 筛选功能正常
□ 搜索功能正常
□ 空状态有友好提示
```

### 文件上传相关
```
□ 文件类型限制正确
□ 文件大小限制合理
□ 上传进度显示
□ 错误处理完善
□ 上传成功有反馈
```

---

## ✅ 审查结果

### 批准条件（所有必须满足）
```
✅ 所有强制检查项通过
✅ 代码质量符合标准
✅ UI/UX符合设计规范
✅ 安全性检查通过
✅ 测试覆盖充分
✅ 文档完善
```

### 请求修改（任一条件触发）
```
❌ 文件大小超过500行
❌ 存在明显的bug
❌ 安全漏洞
❌ 性能问题
❌ UI与设计不符
❌ 测试不充分
```

### 建议改进（非阻塞）
```
💡 代码可以更优化
💡 注释可以更清晰
💡 测试可以更完善
💡 性能可以提升
```

---

## 📝 审查评论模板

### 批准评论
```markdown
✅ **LGTM** (Looks Good To Me)

已完成以下检查：
- [x] 代码质量
- [x] UI/UX
- [x] 安全性
- [x] 性能
- [x] 测试

建议：
- 💡 [可选建议1]
- 💡 [可选建议2]

Approved! 👍
```

### 请求修改评论
```markdown
🔴 **需要修改**

必须修复：
1. ❌ [问题1的描述]
   - 位置：`文件名:行号`
   - 原因：...
   - 建议：...

2. ❌ [问题2的描述]
   - ...

修复后请重新请求审查。
```

### 建议改进评论
```markdown
💡 **建议改进**

代码可以正常工作，但有以下优化建议：

1. 💡 [建议1]
   - 位置：`文件名:行号`
   - 当前实现：...
   - 建议改进：...
   - 收益：...

2. 💡 [建议2]
   - ...

这些是非阻塞建议，可以在后续PR中优化。

If you agree with these suggestions, feel free to merge. Otherwise, let's discuss! 😊
```

---

## 🔗 相关文档

- [编码规范](../standards/coding-standards.md)
- [UI设计规范](../standards/ui-design-standards.md)
- [重构规范](../standards/refactoring-standards.md)
- [安全规范](../standards/security-standards.md)
- [资源管理规范](../standards/resource-management.md)

---

**记住**：严格的Code Review是保证代码质量的最后一道防线！
